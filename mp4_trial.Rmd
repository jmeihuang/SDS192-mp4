---
title: "mp4_trial"
output:
  html_document:
    theme: sandstone
    df_print: paged
    code_folding: "hide"
---

```{r, echo = FALSE, message=FALSE}
##loading the packages and pulling out the imdb dataset
library(tidyverse)
library(RMySQL)
library(dplyr)
db <- dbConnect(MySQL(), 
                host = "scidb.smith.edu", 
                user = "mth292", 
                password = "RememberPi", 
                dbname = "imdb")
knitr::opts_chunk$set(connection = db, max.print = 20)
```

##Top male dominated genres
```{r}
test <- dbGetQuery(db, 'SELECT m.info, t.production_year, ci.movie_id
FROM imdb.cast_info ci
inner join name n on n.id = ci.person_id
inner join title t on t.id = ci.movie_id 
inner join role_type r on r.id = ci.role_id
inner join movie_info m on m.movie_id = ci.movie_id
where m.info_type_id =3
and r.id = 3
and t.production_year >1999
and t.production_year <2019
and m.info in (\"Comedy\", \"Drama\", \"Documentary\", \"Short\" , \"Thriller\");')
```

```{r}
test <- test %>%
  group_by(production_year, info)%>%
  summarise(total =n())

```

```{r}
summarise(total = n())
ggplot(test, aes(x = production_year, y = total))+
  geom_line(color = "red")+
  facet_wrap(~info)
```








